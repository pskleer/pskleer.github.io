<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Solutions Lecture 3 (Chapter 5)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="tutorial-lec3-solutions_files/libs/clipboard/clipboard.min.js"></script>
<script src="tutorial-lec3-solutions_files/libs/quarto-html/quarto.js"></script>
<script src="tutorial-lec3-solutions_files/libs/quarto-html/popper.min.js"></script>
<script src="tutorial-lec3-solutions_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="tutorial-lec3-solutions_files/libs/quarto-html/anchor.min.js"></script>
<link href="tutorial-lec3-solutions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="tutorial-lec3-solutions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="tutorial-lec3-solutions_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="tutorial-lec3-solutions_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="tutorial-lec3-solutions_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="tutorial-lec3-solutions.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Solutions Lecture 3 (Chapter 5)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""> <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&amp;family=Fira+Sans&amp;display=swap" rel="stylesheet"></p>
<p>Make sure to import Numpy, and the linear optimization packages <code>linprog</code> and <code>pulp</code>, to be able to do all exercises.</p>
<div id="dac799ca" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> linprog</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pulp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="question-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-1">Question 1</h4>
<p>Suppose that <span class="math inline">m \geq n</span> and that <span class="math inline">A \in \mathbb{R}^{m \times n}</span> and <span class="math inline">b \in \mathbb{R}^{m}</span>. If the columns of <span class="math inline">A</span> are independent, i.e., if the rank of <span class="math inline">A</span> is <span class="math inline">n</span>, then the unique least squares solution to <span class="math display">
\min_x ||Ax - b||_2.
</span> is given by <span class="math inline">x^* = (A^TA)^{-1}A^Tb</span>. (We need the assumption that <span class="math inline">m \geq n</span> to guarantee that <span class="math inline">(A^TA)^{-1}</span> exists.)</p>
<p>Write a function that takes as input a matrix <span class="math inline">A</span> and vector <span class="math inline">b</span>. It should return the least squares solution <span class="math inline">x^*</span> if <span class="math inline">A</span> has full rank, and a message saying that <span class="math inline">A</span> is not of full rank if not. You may use an if/else-statement for this case distinction.</p>
<p>It should give the following output on the inputs below.</p>
<div id="15d91476" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.61776137</span>, <span class="fl">0.9880466</span>,  <span class="fl">0.93526716</span>],</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.25839379</span>, <span class="fl">0.66983101</span>, <span class="fl">0.55140378</span>],</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.42598981</span>, <span class="fl">0.47034738</span>, <span class="fl">0.67713771</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.05808045</span>, <span class="fl">0.60282648</span>, <span class="fl">0.968094</span>  ],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.6152295</span>,  <span class="fl">0.18224588</span>, <span class="fl">0.23185116</span>]])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.68873052</span>],</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.01618962</span>],</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.67498566</span>],</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.73718501</span>],</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.0448842</span> ]])</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(least_squares(A,b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.05234646]
 [-0.76893707]
 [ 1.3285266 ]]</code></pre>
</div>
</div>
<div id="8d2e077b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.61776137</span>, <span class="fl">0.9880466</span>,  <span class="fl">0.9880466</span>],</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.25839379</span>, <span class="fl">0.66983101</span>, <span class="fl">0.66983101</span>],</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.42598981</span>, <span class="fl">0.47034738</span>, <span class="fl">0.47034738</span>],</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.05808045</span>, <span class="fl">0.60282648</span>, <span class="fl">0.60282648</span>],</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.6152295</span>,  <span class="fl">0.60282648</span>, <span class="fl">0.60282648</span>]])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="fl">0.68873052</span>,<span class="fl">0.01618962</span>, <span class="fl">0.67498566</span>, <span class="fl">0.73718501</span>, <span class="fl">0.0448842</span>])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns are not linearly independent</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(least_squares(A,b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix A is not of full rank</code></pre>
</div>
</div>
<div id="cf6e05c9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> least_squares(A,b):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> np.shape(A)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    rank_A <span class="op">=</span> np.linalg.matrix_rank(A)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> rank_A <span class="op">==</span> n:</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (np.linalg.inv(A.T <span class="op">@</span> A) <span class="op">@</span> A.T) <span class="op">@</span> b</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"Matrix A is not of full rank"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-2">Question 2</h4>
<p>In this exercise we are going to implement <a href="https://en.wikipedia.org/wiki/Cramer%27s_rule">Cramer’s rule</a> for solving the system <span class="math inline">Ax = b</span> in case <span class="math inline">A \in \mathbb{R}^{n \times n}</span> is an invertible matrix. Cramer’s rule determines the solution <span class="math inline">x = [x_0,\dots,x_{n-1}]</span> by <span class="math display">
x_i = \frac{\text{det}(A_i)}{\text{det}(A)} \ \ \ \text{ for } i = 0,\dots,n-1,
</span> where <span class="math inline">A_i</span> is the matrix <span class="math inline">A</span> in which column <span class="math inline">i</span> is replaced by <span class="math inline">b</span>.</p>
<p>Write a function <code>cramer(A,b)</code> that computes the solution <span class="math inline">x</span> according to Cramer’s rule (you may use one for-loop in your implementation).</p>
<p>Your function should give the following output on the given input.</p>
<div id="14b12af6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.61776137</span>, <span class="fl">0.9880466</span>,  <span class="fl">0.93526716</span>],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.25839379</span>, <span class="fl">0.66983101</span>, <span class="fl">0.55140378</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.42598981</span>, <span class="fl">0.47034738</span>, <span class="fl">0.67713771</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a> ])</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="fl">0.68873052</span>, <span class="fl">0.01618962</span>, <span class="fl">0.67498566</span>])</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution with Cramer's rule</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cramer(A,b))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution with np.linalg.solve() for comparison</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.linalg.solve(A,b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[ 2.88381098 -0.97013863 -0.14352512]
[ 2.88381098 -0.97013863 -0.14352512]</code></pre>
</div>
</div>
<div id="7a355edb" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cramer(A, b):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> np.shape(A)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.zeros(m) </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute determinant after replacing i-th column by `b`.</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(m):</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        A_mod <span class="op">=</span> A.copy()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        A_mod[:, i] <span class="op">=</span> b</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="op">=</span> np.linalg.det(A_mod) </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">/</span> np.linalg.det(A) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-3" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-3">Question 3</h4>
<p>Assume we are given a matrix <span class="math inline">A \in \mathbb{R}^{m \times n}</span> so that every subset of <span class="math inline">m</span> columns of <span class="math inline">A</span> are linearly independent. This is, e.g., typically the case if the numbers in <span class="math inline">A</span> would be randomly generated (we will see this later in the course).</p>
<p>One way to obtain a solution to an underdetermined system <span class="math inline">Ax = b</span>, where <span class="math inline">n &gt; m</span>, is to pick a list of indices <span class="math inline">R \subseteq \{0,\dots,n-1\}</span> of size <span class="math inline">|R| = m</span>. Set <span class="math inline">x_i = 0</span> for all <span class="math inline">i \notin R</span> (there are <span class="math inline">n - m</span> of such variables), and determine the values in <span class="math inline">x_R = (x_i)_{i \in R}</span> by solving the system <span class="math inline">Bx_R = b</span>, where <span class="math inline">B</span> is the matrix containing the columns of <span class="math inline">A</span> corresponding to the indices in <span class="math inline">R</span>.</p>
<p>Write a function <code>underdetermined(A,b,R)</code> that takes as input arrays <span class="math inline">A,b</span> and a list <span class="math inline">R</span> as above, and returns a solution <span class="math inline">x \in \mathbb{R}^n</span> to <span class="math inline">Ax = b</span> satisfying the above description.</p>
<p>Your function should give the following output on the given input.</p>
<div id="cb2ace82" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.83</span>, <span class="fl">0.43</span>, <span class="fl">0.16</span>, <span class="fl">0.01</span>, <span class="fl">0.86</span>, <span class="fl">0.87</span>, <span class="fl">0.36</span>, <span class="fl">0.68</span>],</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.29</span>, <span class="fl">0.81</span>, <span class="fl">0.78</span>, <span class="fl">0.97</span>, <span class="fl">0.2</span>,  <span class="fl">0.28</span>, <span class="fl">0.44</span>, <span class="fl">0.07</span>],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a> [<span class="fl">0.18</span>, <span class="fl">0.81</span>, <span class="fl">0.91</span>, <span class="fl">0.88</span>, <span class="fl">0.54</span>, <span class="fl">0.89</span>, <span class="fl">0.53</span>, <span class="fl">0.88</span>]])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="fl">0.68873052</span>, <span class="fl">0.01618962</span>, <span class="fl">0.67498566</span>])</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">7</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine solution</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> underdetermined(A,b,R)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify correctness</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A <span class="op">@</span> x <span class="op">-</span> b) <span class="co"># All numbers almost zero (e-16 is numerical inaccuracies)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[-3.16315793  0.          0.          0.          5.31389279  0.
  0.         -1.84675911]
[-2.22044605e-16  1.28369537e-16  1.11022302e-16]</code></pre>
</div>
</div>
<div id="81f1235a" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> underdetermined(A,b,R):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    m, n <span class="op">=</span> np.shape(A)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.zeros(n)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    x[R] <span class="op">=</span> np.linalg.solve(A[:,R],b)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-4" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-4">Question 4</h4>
<p>In this exercise, we will look into the basics of principle component analysis (PCA); we emphasize this is not a complete explanation, but hopefully helps develop some intuition.</p>
<p>We are given an <span class="math inline">m \times n</span> matrix <span class="math inline">A</span> containing <span class="math inline">n</span> data points, that all have <span class="math inline">m</span> features. That is, every column of <span class="math inline">A</span> corresponds to a data point. It could, e.g., be that we obtained the weight, height, IQ, and age of a group of <span class="math inline">100</span> people. In this case we would have <span class="math inline">m = 4</span> features and <span class="math inline">n = 100</span> data points.</p>
<p>For a given feature, the sample mean <span class="math inline">\bar{\mu}_i</span> of row <span class="math inline">i</span> in <span class="math inline">A</span> is defined as the average of all the values in that row. The (symmetric) <span class="math inline">m \times m</span> covariance matrix <span class="math inline">S</span> is defined by <span class="math display">
S = \frac{1}{n-1} BB^T
</span> where <span class="math inline">B</span> is the matrix that is obtained from <span class="math inline">A</span> by substracting from every row its sample mean (so that every row has mean zero).</p>
<ol type="a">
<li>Write a function <code>covariance</code> that takes as input the matrix <span class="math inline">A</span> and outputs the matrix <span class="math inline">S</span>.</li>
</ol>
<div id="1031152b" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Covariance matrix function</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> covariance(A):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    m,n <span class="op">=</span> np.shape(A)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute matrix S</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> A <span class="op">-</span> np.mean(A, axis<span class="op">=</span><span class="dv">1</span>)[:,<span class="va">None</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    S <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>(B <span class="op">@</span> B.T)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> S</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The covariance matrix contains on its diagonals the sample variance <span class="math display">
\frac{1}{n-1} \sum_{i=0}^{n-1} (x_i - \bar{\mu}_i)^2
</span> and on its off-diagonal elements the covariance of features <span class="math inline">i</span> and <span class="math inline">j</span> at position <span class="math inline">(i,j)</span>. The trace of <span class="math inline">S</span>, the total variance in the data, is equal to the sum of the eigenvalues of the matrix <span class="math inline">S</span>, because of the spectral decomposition (recall from your Linear Algebra course) <span class="math display">
S = \sum_{i=0}^{m-1} \lambda_i v_iv_i^T
</span> where <span class="math inline">\lambda_i</span> are the eigenvalues of <span class="math inline">S</span> and <span class="math inline">v_i</span> the eigenvector of <span class="math inline">\lambda_i</span> for <span class="math inline">i = 1,\dots,m</span>.</p>
<ol start="2" type="a">
<li>Write a function <code>ordered_components</code> that takes as input a symmetric matrix <span class="math inline">S</span> and outputs a vector containing the eigenvalues in ascending order (smallest to largest), and a matrix containing the corresponding eigenvectors ordered according to the order of the eigenvalues. <br> <br> As an example, if we have three eigenvalues <span class="math inline">\{\lambda_0, \lambda_1, \lambda_2\}</span> with <span class="math inline">\lambda_2 \leq \lambda_0 \leq \lambda_1</span>, then then the output should be <span class="math inline">[\lambda_2, \lambda_0, \lambda_1]</span> and the matrix should be <span class="math inline">[v_2 \ v_0 \ v_1]</span> where the <span class="math inline">v_i</span> are the eigenvectors corresponding to eigenvalues <span class="math inline">\lambda_i</span>.<br> <i>Hint: The function <code>np.argsort()</code> from Chapter 4 might be useful here.</i></li>
</ol>
<div id="9969387f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ordered_components(S):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    eig_values, eig_vectors <span class="op">=</span> np.linalg.eig(S)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    order <span class="op">=</span> np.argsort(eig_values)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> eig_values[order], eig_vectors[:,order]    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can view the covariance matrix as a linear sum of “components” being the eigenvectors of <span class="math inline">S</span>, and the corresponding eigenvalues indicates how important a component is for the data, i.e., how much it contributes to the total variance of the data.</p>
<ol start="3" type="a">
<li>Write a function <code>contributions</code> that takes a vector <span class="math inline">x = [x_0,\dots,x_{n-1}]</span> as input and output the numbers <span class="math display">
y_i = \frac{\displaystyle \sum_{j=i}^{n-1} x_j}{\displaystyle \sum_{j=0}^{n-1} x_j}
</span> i.e., <span class="math inline">y_i</span> is the fraction that the last <span class="math inline">i</span> numbers contribute to the sum of all numbers in <span class="math inline">x</span>.</li>
</ol>
<div id="e3b68793" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contributions(x):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x[<span class="op">-</span><span class="dv">1</span>::<span class="op">-</span><span class="dv">1</span>] <span class="co"># Reverse the array</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.cumsum(x)<span class="op">/</span>np.<span class="bu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Your functions in <span class="math inline">a)-c)</span> should give the following output on the indicated input.</p>
<div id="e44ba97a" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stylized data in which there is clear correlation </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># between feature 0 and 1 (but not with the others)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>weight <span class="op">=</span> np.linspace(<span class="dv">60</span>,<span class="dv">90</span>,n)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> np.linspace(<span class="dv">150</span>,<span class="dv">190</span>,n)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>IQ <span class="op">=</span> <span class="dv">110</span><span class="op">*</span>np.ones(n)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>age <span class="op">=</span> np.repeat([<span class="dv">23</span>,<span class="dv">24</span>],np.<span class="bu">round</span>(n<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.vstack((weight,height,IQ,age)) <span class="co">#Can also stack &gt; 2 arrays with vstack()</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.around(A,decimals<span class="op">=</span><span class="dv">1</span>) <span class="co"># Round values in A to one decimal</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'A = </span><span class="ch">\n</span><span class="st">'</span>, A)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute covariance matrix</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> covariance(A)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> np.around(S, decimals <span class="op">=</span> <span class="dv">1</span>) <span class="co"># Round values in S to one decimal</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'S = </span><span class="ch">\n</span><span class="st">'</span>,S)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute eigenvalues and vectors </span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>eig_S, eig_vector_S <span class="op">=</span> ordered_components(S)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Eigenvalues are </span><span class="ch">\n</span><span class="st">'</span>,eig_S)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Eigenvectors are </span><span class="ch">\n</span><span class="st">'</span>,eig_vector_S)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute eigenvalue contributions of k largest eigenvalues</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>eig_contributions <span class="op">=</span> contributions(eig_S)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Contributions of k largest eigenvalues </span><span class="ch">\n</span><span class="st">'</span>, eig_contributions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A = 
 [[ 60.   63.3  66.7  70.   73.3  76.7  80.   83.3  86.7  90. ]
 [150.  154.4 158.9 163.3 167.8 172.2 176.7 181.1 185.6 190. ]
 [110.  110.  110.  110.  110.  110.  110.  110.  110.  110. ]
 [ 23.   23.   23.   23.   23.   24.   24.   24.   24.   24. ]]
S = 
 [[101.9 136.    0.    4.6]
 [136.  181.4   0.    6.2]
 [  0.    0.    0.    0. ]
 [  4.6   6.2   0.    0.3]]
Eigenvalues are 
 [-5.02441935e-02  0.00000000e+00  9.98121483e-02  2.83550432e+02]
Eigenvectors are 
 [[-0.76817281  0.         -0.22461531 -0.59954858]
 [ 0.58467307  0.          0.13549239 -0.7998745 ]
 [ 0.          1.          0.          0.        ]
 [-0.26089832  0.          0.96498175 -0.02724496]]
Contributions of k largest eigenvalues 
 [0.99982522 1.00017717 1.00017717 1.        ]</code></pre>
</div>
</div>
<p>From the output we can see that the largest eigenvalue is much larger than the others, and accounts for almost all of the total variance (sum of the eigenvalues). This implies that the data in <span class="math inline">A</span>, which are data points in <span class="math inline">\mathbb{R}^4</span>, are essentially contained in a <span class="math inline">1</span>-dimensionsal subspace of <span class="math inline">\mathbb{R}^4</span> formed by the “principle component” being the eigenvector of the largest eigenvalue, and so the “dimension of the data” is in this sense smaller than that of the data itself, i.e.,</p>
<p><span class="math display">
S \approx \lambda_{\max} v_{\max}v_{\max}^T.
</span></p>
<p>Such insights can help identify which features are stastistically important in the data, and which are not.</p>
</section>
<section id="question-5" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-5">Question 5</h4>
<p>Consider a knapsack problem in which we have <span class="math inline">k = n^2</span> items <span class="math inline">I = \{1,\dots,k\}</span> that all have a weight <span class="math inline">w_i</span> and value <span class="math inline">v_i</span> for <span class="math inline">i \in I</span>. We want to select a subset of items whose total weight is at most <span class="math inline">W</span>, whilst their total value is maximized at the same time. Furthermore, we can select at most <span class="math inline">r</span> from the first <span class="math inline">n</span> items <span class="math inline">\{1,\dots,n\}</span>, at most <span class="math inline">r</span> from the second <span class="math inline">n</span> items <span class="math inline">\{n+1,\dots,2n\}</span> etc…</p>
<p>This problem can be modelled with the following binary linear optimization problem, where the modeling means <span class="math inline">x_i = 1</span> if item <span class="math inline">i</span> is included, and <span class="math inline">x_i = 0</span> otherwise.</p>
<p><span class="math display">
\begin{array}{lllll}
\max &amp; \displaystyle \sum_{i=1}^{n^2} v_ix_i &amp; &amp; \\
\rm{s.t. } &amp; \displaystyle \sum_{i=a\cdot n+1}^{(a+1)\cdot n} x_{i} &amp;  \leq &amp; r &amp; \text{for } a = 0,\dots,n-1 \\
&amp; \displaystyle \sum_{i=1}^{n^2} w_ix_{i} &amp;  \leq &amp; W &amp; \\
&amp; x_{i}  &amp;\in &amp; [0,1] &amp; \text{for all } i = 1,\dots,n^2 \\
&amp; x_{i} &amp; \in &amp; \{0,1\} &amp; \text{for all } i = 1,\dots,n^2
\end{array}
</span></p>
<p>Define a function <code>knapsack(n,v,w,W,r)</code> that takes as input <span class="math inline">n</span>, the weight and values vectors <span class="math inline">v,w \in \mathbb{R}^{n^2}</span>, and the numbers <span class="math inline">W</span> and <span class="math inline">r</span>, and returns the optimal solution to the problem above as a binary vector using <code>linprog</code>. <br><br> Generate the constraint matrix using NumPy functions; it might help to start with <code>np.eye(n)</code> which is the <span class="math inline">n \times n</span> identity matrix. You may use list comprehension once in your function when defining the bounds on the variables. As an example, note that for <span class="math inline">k = 9</span>, i.e., <span class="math inline">n = 3</span>, the constraint matrix of the inequalities should look like this: <span class="math display">
\left[
\begin{matrix}
1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp;0 &amp;0 &amp;0 &amp;0 &amp;\\
0 &amp; 0 &amp;0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp;0 \\
0 &amp; 0 &amp;0  &amp; 0 &amp; 0 &amp;0 &amp; 1 &amp; 1 &amp; 1\\
w_1 &amp; w_2 &amp; w_3 &amp; w_4 &amp; w_5 &amp; w_6 &amp; w_7 &amp; w_8 &amp; w_9
\end{matrix}
\right].
</span></p>
<div id="1ef52b97" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.arange(<span class="dv">1</span>,n<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.arange(n<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>n<span class="op">**</span><span class="dv">2</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>solution <span class="op">=</span> knapsack(n,v,w,W,r)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Solution is </span><span class="ch">\n</span><span class="st">'</span>,solution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solution is 
 [ 1.  1. -0.  1.  1. -0.  1.  1.  0.]</code></pre>
</div>
</div>
<div id="122993b1" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from scipy.optimize import linprog (already did this at top of exercise file)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knapsack(n,v,w,W,r):</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> w[<span class="va">None</span>,:] <span class="co"># Turn into vector of shape (1,n**2);</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># this is important for np.vstack() later on</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coefficients of the objective function</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="op">-</span>v <span class="co"># Maximization to minimization</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Matrix of the inequality constraints (Ux &lt;= z)</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.eye(n)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.repeat(x,n).reshape(n,n<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    U <span class="op">=</span> np.vstack((x,w))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RHS of the inequality constraints (Ux &lt;= z)</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> np.hstack((r<span class="op">*</span>np.ones(n),W))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bounds for the variables x1 and x2 (l = 0, u = 1)</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    x_bounds <span class="op">=</span> [(<span class="dv">0</span>,<span class="dv">1</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n<span class="op">**</span><span class="dv">2</span>)]</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Optimize model</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> linprog(c, A_ub<span class="op">=</span>U, b_ub<span class="op">=</span>z, <span class="op">\</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                    bounds<span class="op">=</span>x_bounds, <span class="op">\</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                    integrality<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-6" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="question-6">Question 6</h4>
<p>Implement and solve the problem from Question 5 with the PuLP package, i.e., write the function <code>knapsack_pulp(n,v,w,W,r)</code> that yields the same output.</p>
<div id="fb78bf5a" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.arange(<span class="dv">1</span>,n<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.arange(n<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> <span class="dv">3</span><span class="op">*</span>n<span class="op">**</span><span class="dv">2</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>solution <span class="op">=</span> knapsack_pulp(n,v,w,W,r)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Solution is </span><span class="ch">\n</span><span class="st">'</span>,solution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solution is 
 [1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0]</code></pre>
</div>
</div>
<div id="f3730a10" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import pulp (already did this at top of exercise file)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> knapsack_pulp(n,v,w,W,r):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># n does not necessarily have to be an input argument</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We could have obtained it from v with np.sqrt(np.size(v)).astype(int)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> n<span class="op">**</span><span class="dv">2</span> <span class="co"># Total number of items</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Instantiate problem</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">=</span> pulp.LpProblem(<span class="st">"Knapsack"</span>, pulp.LpMaximize)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># With list comprehension</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.array([pulp.LpVariable(<span class="ss">f"x_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, cat<span class="op">=</span><span class="st">'Binary'</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k)])</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set objective function</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">+=</span> pulp.lpSum(v<span class="op">*</span>x)  </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set constraints</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        prob <span class="op">+=</span> pulp.lpSum([x[i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(a<span class="op">*</span>n,(a<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>n)]) <span class="op">&lt;=</span> r</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    prob <span class="op">+=</span> pulp.lpSum(w<span class="op">*</span>x) <span class="op">&lt;=</span> W</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Solve the problem</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    prob.solve()</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [pulp.value(x[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>