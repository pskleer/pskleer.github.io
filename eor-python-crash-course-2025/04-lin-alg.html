<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Linear algebra – Python for Econometrics and Operations Research</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./05-linear-optimization.html" rel="next">
<link href="./03-basics.html" rel="prev">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-a6e161b2431e1f94a14e0f5d32135a3c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-fe80fb519f0892010506c40733b33e0a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-lin-alg.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear algebra</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Python for Econometrics and Operations Research</a> 
        <div class="sidebar-tools-main">
    <a href="./Python-for-Econometrics-and-Operations-Research.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Welcome</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Software</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-lin-alg.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-linear-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear optimization</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link active" data-scroll-target="#packages"><span class="header-section-number">4.1</span> Packages</a></li>
  <li><a href="#why-numpy-and-sympy" id="toc-why-numpy-and-sympy" class="nav-link" data-scroll-target="#why-numpy-and-sympy"><span class="header-section-number">4.2</span> Why <code>numpy</code> and <code>sympy</code>?</a></li>
  <li><a href="#basic-matrix-and-vector-operations-with-numpy" id="toc-basic-matrix-and-vector-operations-with-numpy" class="nav-link" data-scroll-target="#basic-matrix-and-vector-operations-with-numpy"><span class="header-section-number">4.3</span> Basic matrix and vector operations with Numpy</a></li>
  <li><a href="#application-input-output-models" id="toc-application-input-output-models" class="nav-link" data-scroll-target="#application-input-output-models"><span class="header-section-number">4.4</span> Application: input-output models</a></li>
  <li><a href="#matrix-operations-inverse-determinant-solving-linear-systems" id="toc-matrix-operations-inverse-determinant-solving-linear-systems" class="nav-link" data-scroll-target="#matrix-operations-inverse-determinant-solving-linear-systems"><span class="header-section-number">4.5</span> Matrix operations: inverse, determinant, solving linear systems</a></li>
  <li><a href="#modifying-matrix-entries" id="toc-modifying-matrix-entries" class="nav-link" data-scroll-target="#modifying-matrix-entries"><span class="header-section-number">4.6</span> Modifying matrix entries</a></li>
  <li><a href="#linear-transformations-of-images" id="toc-linear-transformations-of-images" class="nav-link" data-scroll-target="#linear-transformations-of-images"><span class="header-section-number">4.7</span> Linear transformations of images</a></li>
  <li><a href="#symbolic-computations-sympy" id="toc-symbolic-computations-sympy" class="nav-link" data-scroll-target="#symbolic-computations-sympy"><span class="header-section-number">4.8</span> Symbolic computations: sympy</a></li>
  <li><a href="#application-supply-and-demand-model" id="toc-application-supply-and-demand-model" class="nav-link" data-scroll-target="#application-supply-and-demand-model"><span class="header-section-number">4.9</span> Application: supply and demand model</a></li>
  <li><a href="#symbolic-computation-of-the-determinant-in-python-with-sympy" id="toc-symbolic-computation-of-the-determinant-in-python-with-sympy" class="nav-link" data-scroll-target="#symbolic-computation-of-the-determinant-in-python-with-sympy"><span class="header-section-number">4.10</span> Symbolic computation of the determinant in Python with <code>sympy</code></a></li>
  <li><a href="#optional-row-reduction-with-intermediate-steps" id="toc-optional-row-reduction-with-intermediate-steps" class="nav-link" data-scroll-target="#optional-row-reduction-with-intermediate-steps"><span class="header-section-number">4.11</span> (Optional) Row reduction with intermediate steps</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear algebra</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""> <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&amp;family=Fira+Sans&amp;display=swap" rel="stylesheet"></p>
<p>In this chapter we will learn how to use Python for linear algebra.</p>
<section id="packages" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="packages"><span class="header-section-number">4.1</span> Packages</h2>
<p>In the first session of this crash course you have learned the basics of Python: how to use Python as a calculator, use lists, for-loops, and if-else-statements.</p>
<p>Python can be used for much more advanced operations as well. As you can imagine, code quickly grows more complicated. Fortunately, we can reuse code written by other through so-called <strong>packages</strong> (or libraries). In the optional <a href="03-basics.html#sec-math-basics" class="quarto-xref"><span>Section 3.6</span></a> you might have seen several packages already.</p>
<p>Using packages has several advantages. If you use a standard package, then it makes your code more readable. It also reduces the risk of errors: Python packages are typically developed by expert programmers and thoroughly tested before they are released to the public. For the mainstream packages that we will be using, you can thus be reasonably confident that they deliver what they promise.</p>
<p>Another major advantage of packages is that they are often heavily optimized in terms of speed and memory efficiency.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Today we will use several well-known packages:</p>
<ul>
<li><a href="https://numpy.org/">NumPy</a>,</li>
<li>Sympy,</li>
<li>and <a href="https://matplotlib.org/">Matplotlib</a>.</li>
</ul>
<p>In a nutshell: packages are functions written by other people to make our life easy, i.e., so that we do not have to write every code file from scratch in Python.</p>
<p><em>The NumPy, SymPy and Matplotlib packages should be installed in a standard Anaconda installation. If you have another Python installation, typically using the PIP package manager should allow you to install packages. In this case, commands like <code>pip install numpy</code> and <code>pip install sympy</code> should do the job.</em></p>
</section>
<section id="why-numpy-and-sympy" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="why-numpy-and-sympy"><span class="header-section-number">4.2</span> Why <code>numpy</code> and <code>sympy</code>?</h2>
<p>The package <code>numpy</code> is designed for fast numerical calculations, e.g., with matrices. We can compute matrix products, solve linear systems, and compute inverses with <code>numpy</code> very quicky. The package <code>sympy</code>, on the other hand, is a symbolic mathematics library. It can do exact algebraic manipulations (also with variables x and y), but it is less quick than numerical computations with <code>numpy</code>. <code>sympy</code> also contains a method to do exact row-reduction, to bring a matrix into reduced echelon form. This may also be useful if you did row-reduction by hand and want to verify your result with the computer.</p>
</section>
<section id="basic-matrix-and-vector-operations-with-numpy" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="basic-matrix-and-vector-operations-with-numpy"><span class="header-section-number">4.3</span> Basic matrix and vector operations with Numpy</h2>
<p>Suppose we have the following vectors <span class="math inline">\mathbf{x}</span> and <span class="math inline">\mathbf{y}</span>, and matrix <span class="math inline">A</span>: <span class="math display">
\mathbf{x}=\left[\begin{array}{c}1\\2\\3 \end{array} \right], \mathbf{y}=\left[\begin{array}{c}4\\5\\7 \end{array} \right],  A =  \begin{bmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{bmatrix}
</span></p>
<p>We can define vectors in Python as so-called NumPy arrays. Think of these as lists (that we saw earlier) on which we can perform numerical computations. To create such arrays, we have to import the NumPy package <code>numpy</code>. We do this under the <em>alias</em> <code>np</code> (so that we can use the short-hand notation <code>np</code> for <code>numpy</code> everywhere).</p>
<div id="bcf9f2ef" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the vectors and matrix</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">7</span>])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In Python, we can add vectors, compute the matrix-vector product and multiply matrices. Note: To compute a matrix-vector product you use the command <code>A@x</code>. What happens if you use the command <code>A*x</code>? Now, try to compute <span class="math inline">A\mathbf{x}</span>, <span class="math inline">A\mathbf{y}</span>, and <span class="math inline">A(\mathbf{x}+\mathbf{y})</span> with Python. What do you notice?</p>
<div id="ebb7868c" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="application-input-output-models" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="application-input-output-models"><span class="header-section-number">4.4</span> Application: input-output models</h2>
<p>(From Python Linear Algebra Notebook by Herbert Hamers)</p>
<p>A chemical plant receives oil from three different regions: the Middle East, South America, and the NorthSea. The quality of the oil is different for each region. These oils will be used to produce gasoline, diesel fuel, and bike chain oil. The oil from the Middle east will be only used for the production of gasoline. Of the oil of South America, <span class="math inline">20</span> % will be used for the production of gasoline, and <span class="math inline">80</span> % for the production of diesel fuel. Finally, <span class="math inline">25</span> % of the North Sea oil will be used to produce gasoline, <span class="math inline">25</span> % to produce diesel fuel, and 50 % for the production of bike chain oil.</p>
<p>Suppose today a shipment arrives of <span class="math inline">5000</span> barrels of oil from the Middle East, <span class="math inline">9000</span> barrels of oil from South America, and <span class="math inline">1000</span> barrels from the North Sea. The plant wants to know how much gasoline, diesel fuel, and bike chain oil it can produce from this shipment.</p>
<p>Obviously, the <span class="math inline">5000</span> barrels of oil from the Middle East will completely be used for the production of gasoline, i.e.&nbsp;<span class="math inline">1\cdot 5000 = 5000</span> barrels of gasoline. Of the <span class="math inline">9000</span> barrels of South America oil, <span class="math inline">20</span> % will be used for the production of gasoline. Hence, this leads to <span class="math inline">0.2 \cdot 9000 = 1800</span> barrels of gasoline. Finally, of the <span class="math inline">1000</span> barrels of North sea oil 25 % will be used for the production of gasoline. Hence, we obtain <span class="math inline">0.25\cdot 1000 = 250</span> barrels of gasoline. Hence, the total number of barrels of gasoline that will be produced is <span class="math display">
1 \cdot 5000 + 0.2 \cdot 9000 + 0.25 \cdot 1000 = 5000+1800+250=7050.
</span> By a similar computation, one can compute the total number of barrels of diesel fuel: <span class="math display">
0 \cdot 5000 + 0.8 \cdot 9000 + 0.25 \cdot 1000 = 7450.
</span> Finally, one can show that the total number of barrels of bike chain oil is <span class="math inline">500</span>, using a similar computation.</p>
<p>The production process can be summarized using the matrix-vector product. The production process is represented by the following matrix <span class="math display">
\begin{bmatrix} 1 &amp; 0.2 &amp; 0.25 \\ 0 &amp; 0.8 &amp; 0.25 \\ 0 &amp;0 &amp;0.5 \end{bmatrix},
</span> where the first column represents the division in the three end products of the Middle East oil, the second column represents the division in the three end products of the South America oil, and the third column represents the division in the three end products of the North Sea oil.</p>
<div id="66d5ebd7" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>np.array([[<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.25</span>],[<span class="dv">0</span>,<span class="fl">0.8</span>,<span class="fl">0.25</span>],[<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>]])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1.   0.2  0.25]
 [0.   0.8  0.25]
 [0.   0.   0.5 ]]</code></pre>
</div>
</div>
<p>The shipment of the oil can be summarized by the following vector: <span class="math display">
q = \begin{bmatrix} 5000 \\ 9000 \\ 1000 \end{bmatrix}
</span></p>
<p>Using the matrix-vector product, it can easily be calculated how much gasoline, diesel fuel, and bike chain oil can be produced from this oil-delivery: <span class="math display">
Aq = \begin{bmatrix} 1 &amp; 0.2 &amp; 0.25 \\ 0 &amp; 0.8 &amp; 0.25 \\ 0 &amp;0 &amp;0.5 \end{bmatrix} \begin{bmatrix} 5000 \\ 9000 \\ 1000 \end{bmatrix} = \begin{bmatrix} 1 \cdot 5000 + 0.2 \cdot 9000 + 0.25 \cdot 1000 \\ 0 \cdot 5000 + 0.8 \cdot 9000 + 0.25 \cdot 1000\\ 0 \cdot 5000 + 0 \cdot 9000 + 0.5 \cdot 1000  \end{bmatrix}  = \begin{bmatrix} 7050 \\ 7450 \\ 500 \end{bmatrix}
</span></p>
<p>Hence, using the matrix-vector product we come to the same conclusion: the oil-delivery will result in 7050 barrels of gasoline, 7450 barrels of diesel fuel, and 500 barrels of bike chain oil.</p>
<p>The next day a shipment of 10000 barrels of oil from the Middle East, 1000 barrels of South America, and 200 barrels of the North Sea arrives. Determine the output of gasoline, diesel fuel, and key chain oil of this oil-delivery.</p>
<div id="531b4ddf" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Let us continue with a variation on the above problem.</p>
<p>Now, a chemical plant receives oil from five different regions: the Middle East, South America, the North Sea,Africa and Asia. Again, the quality of the oil is different for each region. These oils will be used to produce gasoline, diesel fuel, bike chain oil, fuel <span class="math inline">95</span> and fuel <span class="math inline">98</span>. The oil from the Middle east will be only used for the production of gasoline. Of the oil of South America, <span class="math inline">20</span>% will be used for the production of gasoline, and <span class="math inline">80</span>% for the production of diesel fuel. <span class="math inline">25</span>% of the North Sea oil will be used to produce gasoline, <span class="math inline">25</span>% to produce diesel fuel, and <span class="math inline">50</span>% for the production of bike chain oil. Of the oil of Africa, <span class="math inline">10</span>% will be used for the production of gasoline, <span class="math inline">10</span>% for the production of bike chain oil, <span class="math inline">30</span>% for the production of fuel <span class="math inline">95</span> and <span class="math inline">50</span>% for the production of fuel <span class="math inline">98</span>. Finally, <span class="math inline">30</span>% of the Asia oil will be used to produce gasoline, <span class="math inline">5</span> % to produce diesel fuel, <span class="math inline">50</span> % for the production of fuel <span class="math inline">95</span>, and <span class="math inline">15</span>% for the production of fuel <span class="math inline">98</span>.</p>
<p>Suppose today a shipment arrives of <span class="math inline">5000</span> barrels of oil from the Middle East, <span class="math inline">9000</span> barrels of oil from South America, <span class="math inline">1000</span> barrels from the North Sea, <span class="math inline">4000</span> barrels of oil from Africa, and 4000 barrels of oil from Asia. The plant wants to know how much gasoline, diesel fuel, bike chain oil, fuel <span class="math inline">95</span>, and fuel <span class="math inline">98</span> it can produce from this shipment.</p>
<p>With the new information <span class="math inline">A</span> will be a 5x5 matrix and <span class="math inline">q</span> will be a 5x1 vector. Determine the output of gasoline, diesel fuel, bike chain oil, fuel <span class="math inline">95</span>, and fuel <span class="math inline">98</span> of this oil-delivery.</p>
<div id="016ab85a" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="matrix-operations-inverse-determinant-solving-linear-systems" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="matrix-operations-inverse-determinant-solving-linear-systems"><span class="header-section-number">4.5</span> Matrix operations: inverse, determinant, solving linear systems</h2>
<p>Assuming we imported NumPy under the alias <code>np</code>, the module <code>np.linalg</code> from NumPy contains several standard linear algebra methods that we will encounter today.</p>
<ul>
<li><code>det(A)</code>: Determinant of matrix <span class="math inline">A</span></li>
<li><code>inv(A)</code>: Inverse of matrix <span class="math inline">A</span></li>
<li><code>solve(A,b)</code>: Solution to linear system <span class="math inline">A x =b</span></li>
</ul>
<p>To use such a method, you should use the syntax <code>np.linalg.method_name</code> with <code>method_name</code> replaced by one of the three options above.</p>
<div id="d65adf91" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">0</span>]]) <span class="co">#Define A</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The determinant of A is"</span>, np.linalg.det(A))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 1]
 [1 0]]
The determinant of A is -1.0</code></pre>
</div>
</div>
<p><strong>Exercise 5.1:</strong></p>
<ol type="i">
<li>Compute the determinant of the following matrices</li>
</ol>
<p><span class="math display">
A = \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix}, \qquad B = \begin{pmatrix} 1 &amp; 2 &amp; 3 \\ 2 &amp; 3 &amp; 4 \\ 1 &amp; 1 &amp; 1 \end{pmatrix}, \qquad C = \begin{pmatrix} 1 &amp; 3 &amp; 2 \\ 2 &amp; 3 &amp; 7 \\ 1 &amp; 3 &amp; 1 \end{pmatrix}
</span></p>
<ol start="2" type="i">
<li>Which of the matrices <span class="math inline">A</span>, <span class="math inline">B</span>, <span class="math inline">C</span> are invertible? For each of these matrices, compute the inverse.</li>
</ol>
<div id="2375cb16" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here </span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Exercise 5.2</strong>:</p>
<p>In the Linear Algebra course we have seen that if we multiply a single row by a constant <span class="math inline">k</span>, then the determinant gets multiplied by <span class="math inline">k</span> as well.</p>
<ol type="i">
<li><p>Verify this (using Python) for the matrix obtained from <span class="math inline">C</span> by multiplying the first row by <span class="math inline">10</span>: <span class="math display">
D = \begin{pmatrix} 10 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1\end{pmatrix} C
</span></p></li>
<li><p>What is <span class="math inline">\det(10 C)</span>?</p></li>
</ol>
<div id="13e020c2" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can use Python to solve linear systems of equations using <code>numpy</code>. Consider for example the following system of equations:</p>
<p><span class="math display">
\left\{\begin{array}{rl}
x_1 - 3x_2  &amp;= 5 \\
-x_1 +x_2 +5x_3 &amp;= 2 \\
x_2 + x_3 &amp;= 0
\end{array}\right.
</span></p>
<p>We can solve the system very efficiently numerically with the command <code>np.linalg.solve(A,b)</code>:</p>
<div id="3913e67f" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient matrix A</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>],</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>              [<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>],</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>              [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]])</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-hand side vector b</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">0</span>])</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the system</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.solve(A, b)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Solution:"</span>, x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Solution: [ 2. -1.  1.]</code></pre>
</div>
</div>
<p>As you can see, the solution is <span class="math inline">x_1=2.0, x_2=-1.0, x_3=1.0</span>. Note that the output is <em>numerical</em> i.e., it is an approximation computed with finite precision arithmetic inside the computer. <code>numpy</code> is faster for large systems than <code>sympy</code>, but it may introduce tiny rounding errors (e.g., <span class="math inline">2.00000000001</span> instead of <span class="math inline">2</span>).</p>
<p><strong>Exercise 5.3:</strong> Use <code>numpy</code> to solve the following system:</p>
<p><span class="math display">
\left\{\begin{array}{rl}
x_1 - 3x_2 + 4x_3 &amp;= -4 \\
3x_1 -7x_2 +7x_3 &amp;= -8 \\
-4x_1 + 6x_2 + 2x_3 &amp;= 4
\end{array} \right.
</span></p>
<div id="f61f9904" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="modifying-matrix-entries" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="modifying-matrix-entries"><span class="header-section-number">4.6</span> Modifying matrix entries</h2>
<p>Consider the following large matrix <span class="math inline">A</span>, and a zero matrix <span class="math inline">B</span> of the same size as <span class="math inline">A</span>:</p>
<div id="24389178" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">11</span>, <span class="dv">8</span>],</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">1</span>, <span class="dv">13</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">3</span>],</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">11</span>, <span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">12</span>],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">11</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">13</span>],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">11</span>],</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">2</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">11</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">1</span>],</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">13</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">7</span>],</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">12</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">11</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">14</span>, <span class="dv">7</span>, <span class="dv">10</span>],</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>],</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">2</span>, <span class="dv">12</span>]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>B<span class="op">=</span>np.zeros((<span class="dv">10</span>,<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We can modify entries of <span class="math inline">B</span> separately. E.g., we can modify the top-left entry of <span class="math inline">B</span> to be <span class="math inline">100</span>:</p>
<div id="c86fdf2f" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>B[<span class="dv">0</span>,<span class="dv">0</span>]<span class="op">=</span><span class="dv">100</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(B)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[100.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]
 [  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.]]</code></pre>
</div>
</div>
<p><strong>Exercise 5.4:</strong> Use for loops over the row indices <span class="math inline">i</span> and column indices <span class="math inline">j</span> to modify the entries of <span class="math inline">B</span> as follows, for each entry of <span class="math inline">A</span>:</p>
<ul>
<li>If <span class="math inline">A_{ij} &lt; 6</span>, set <span class="math inline">B_{ij} =100</span>.</li>
<li>If <span class="math inline">A_{ij} \geq 6</span>, set <span class="math inline">B_{ij} = A_{ij}</span>.</li>
</ul>
<p>Then, compute the sum of all entries in <span class="math inline">B</span> with <code>np.sum(B)</code>. What is the result?</p>
<div id="d2b66a95" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="linear-transformations-of-images" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="linear-transformations-of-images"><span class="header-section-number">4.7</span> Linear transformations of images</h2>
<p>In this section we will illustrate the concept of applying linear transformations to real-life images. We use the <code>cv2</code> library, the <code>numpy</code> library, and the <code>matplotlib</code> packages for this.</p>
<p><em>The above packages should be installed in a standard Anaconda installation. If you have another Python installation, typically using the PIP package manager should allow you to install packages. In this case, commands like “pip install opencv-python” “pip install numpy” “pip install matplotlib” in a (Windows) powershell should do the job.</em></p>
<div id="b93840ce" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>A linear transformation for a vector in <span class="math inline">\mathbb{R}^2</span> can be represented by <span class="math display">
\begin{bmatrix}x'\\ y' \end{bmatrix}= \begin{bmatrix}a_{11}&amp; a_{12} \\ a_{21}&amp; a_{22} \\ \end{bmatrix}\begin{bmatrix}x\\ y\end{bmatrix}
</span></p>
<p>For images, <span class="math inline">(x,y)</span> are the pixel coordinates of the original image and <span class="math inline">(x',y')</span> are the pixel coordinates of the transformed image. First we load in an image (this can be any image with the name `image.jpg’, but it must be in the same folder as the Python notebook):</p>
<style>
.cell-output-display {
  background-color: #ffffff;
}
</style>
<div id="f787d9ac" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>img2 <span class="op">=</span> cv2.imread(<span class="st">'image.jpg'</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(img2[:,:,::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">'off'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-lin-alg_files/figure-html/cell-16-output-1.png" class="quarto-figure quarto-figure-center figure-img" width="512" height="389"></p>
</figure>
</div>
</div>
</div>
<p>The picture can be seen as a set of points in <span class="math inline">\mathbb{R}^2</span>, corresponding to the pixels, where each point is assigned a color. We are now going to move the points according to a linear transformation <span class="math inline">\mathbb{R}^2 \to \mathbb{R}^2</span> which maps <span class="math inline">\mathbf{x}</span> to <span class="math inline">A\textbf{x}</span>.</p>
<p>We first predefine a Python function called <code>perform_Transformation()</code> to apply a transformation to the image. You don’t have to understand this code, but only remember that its purpose is to apply transformations to images. The function takes as input an image and a transformation matrix.</p>
<div id="4ec381e6" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to apply transformation and visualize the result (source: kaggle.com)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_Transformation(image, A):</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    rows,cols,ch <span class="op">=</span> image.shape</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> np.array([[A[<span class="dv">0</span>,<span class="dv">0</span>], A[<span class="dv">0</span>,<span class="dv">1</span>], <span class="dv">0</span>],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                [A[<span class="dv">1</span>,<span class="dv">0</span>], A[<span class="dv">1</span>,<span class="dv">1</span>], <span class="dv">0</span>]])</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    dst <span class="op">=</span> cv2.warpAffine(image,M,(cols,rows))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize <span class="op">=</span> (<span class="dv">24</span>,<span class="dv">8</span>))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">211</span>)<span class="op">;</span> plt.imshow(image[:,:,::<span class="op">-</span><span class="dv">1</span>])<span class="op">;</span> plt.title(<span class="st">'Original Image'</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">212</span>)<span class="op">;</span> plt.imshow(dst[:,:,::<span class="op">-</span><span class="dv">1</span>])<span class="op">;</span> plt.title(<span class="st">"Transformed Image"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next, we create a 2x2 (transformation) matrix <span class="math inline">A</span> and use the image that we stored in <code>img2</code> variable and apply the transformation function to these inputs. The function prints both the original and transformed image.</p>
<div id="e0ac1276" class="cell" data-execution_count="17">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The matrix A scales the picture down 50% in both the x direction and y direction</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="fl">0.5</span>,<span class="dv">0</span>],</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">0</span>,<span class="fl">0.5</span>]])</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>perform_Transformation(img2, A)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lin-alg_files/figure-html/cell-18-output-1.png" width="421" height="653" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Exercise 5.5:</strong></p>
<ol type="i">
<li><p>Can you scale the picture 50% down in the <span class="math inline">x</span>-direction only?</p></li>
<li><p>Investigate what the matrix <span class="math inline">A=\begin{bmatrix} 0  &amp;1 \\ 1 &amp; 0  \end{bmatrix}</span> does to the picture. Can you explain why?</p></li>
</ol>
<div id="b283b7e2" class="cell" data-execution_count="18">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The following matrix rotates the picture approximately 45 degrees (note that <span class="math inline">\sin(\pi/4) = \cos(\pi/4) \approx 0.707</span>). Sadly, the image is only partly visible then.</p>
<div id="ca3e3601" class="cell" data-execution_count="19">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The matrix A rotates the picture 45 degrees</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="fl">0.707</span>,<span class="op">-</span><span class="fl">0.707</span>],</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                [<span class="fl">0.707</span>,<span class="fl">0.707</span>]])</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>perform_Transformation(img2, A)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="04-lin-alg_files/figure-html/cell-20-output-1.png" width="421" height="653" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>Exercise 5.6:</strong></p>
<ol type="i">
<li><p>Let <span class="math inline">A=\begin{bmatrix} 0.5  &amp;0 \\ 0 &amp; 1  \end{bmatrix}</span> and <span class="math inline">B= \begin{bmatrix} 0  &amp;1 \\ 1 &amp; 0  \end{bmatrix}</span>. Compute the matrix products <span class="math inline">AB</span> and <span class="math inline">BA</span>.</p></li>
<li><p>Investigate what the matrix <span class="math inline">BA= \begin{bmatrix} 0  &amp;1 \\ 1 &amp; 0  \end{bmatrix}\begin{bmatrix} 0.5  &amp;0 \\ 0 &amp; 1  \end{bmatrix}</span> does to the picture. Can you explain why?</p></li>
<li><p>What does the matrix <span class="math inline">AB = \begin{bmatrix} 0.5  &amp;0 \\ 0 &amp; 1  \end{bmatrix} \begin{bmatrix} 0  &amp;1 \\ 1 &amp; 0  \end{bmatrix}</span> to the picture and why?</p></li>
<li><p>Can you scale the picture 50% down in the <span class="math inline">x</span>-direction only, and then rotate the picture (approximately) 45 degrees? What matrix corresponds to this?</p></li>
</ol>
<div id="33435435" class="cell" data-execution_count="20">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="symbolic-computations-sympy" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="symbolic-computations-sympy"><span class="header-section-number">4.8</span> Symbolic computations: sympy</h2>
<p>The <code>sympy</code> library is for symbolic computations. We will now demonstrate how this library works. <code>sympy</code> also contains a function to bring a matrix into reduced echelon form. This is very useful if you want to verify manual calculations.</p>
<div id="8a2b4158" class="cell" data-execution_count="21">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We now show how to solve the following system of equations:</p>
<p><span class="math display">
\left\{\begin{array}{l}
x_1 - 3x_2 + 4x_3 = -4 \\
3x_1 -7x_2 +7x_3 = -8 \\
-4x_1 + 6x_2 + 2x_3 = 4
\end{array}\right.
</span> The augmented matrix of the system of linear equations is</p>
<p><span class="math display">
\left[\begin{array}{ccc|c}
1 &amp; -3 &amp; 4 &amp; -4 \\
3 &amp; -7 &amp; 7 &amp; -8 \\
-4 &amp; 6 &amp; 2 &amp; 4 \\
\end{array}\right]
</span></p>
<p>In Python you can do this with <code>sympy</code> as follows.</p>
<div id="4062fa80" class="cell" data-execution_count="22">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Ab<span class="op">=</span>sp.Matrix([[<span class="dv">1</span>,<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="op">-</span><span class="dv">4</span>],[<span class="dv">3</span>,<span class="op">-</span><span class="dv">7</span>,<span class="dv">7</span>,<span class="op">-</span><span class="dv">8</span>],[<span class="op">-</span><span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>]])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Now we can find the reduced form of the system using <code>rref()</code> from the <code>sympy</code> library. The method returns two elements. The first is the row-reduced echelon form of the matrix, and the second is a list of the pivot columns. By typing <code>Ab_rref[0]</code>, only the row-reduced echelon form is printed.</p>
<div id="68f41814" class="cell" data-execution_count="23">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Ab_rref <span class="op">=</span> Ab.rref()</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Ab_rref[<span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="23">
<p><span class="math inline">\displaystyle \left[\begin{matrix}1 &amp; 0 &amp; 0 &amp; 2\\0 &amp; 1 &amp; 0 &amp; 2\\0 &amp; 0 &amp; 1 &amp; 0\end{matrix}\right]</span></p>
</div>
</div>
<p>The system is consistent and we can immediately see the general solution: <span class="math inline">x_1=2</span>, <span class="math inline">x_2=2</span> and <span class="math inline">x_3=0</span>. The solution is exact, e.g., Python did not round the number 2 to 2.00000 as it does when using the <code>numpy</code> module. <code>sympy</code> allows us to do exact computation with matrices, as opposed to approximate computations with <code>numpy</code>. Computations with <code>sympy</code> are generally slower than with <code>numpy</code>, so for very large systems, <code>numpy</code> is preferred.</p>
<p><strong>Exercise 5.7:</strong> Use Python to solve the following system of equations:</p>
<p><span class="math display">
\left\{\begin{array}{l}
x_1 - 3x_2  = 5 \\
-x_1 +x_2 +5x_3 = 2 \\
x_2 + x_3 = 0
\end{array}\right.
</span></p>
<div id="9cb6f272" class="cell" data-execution_count="24">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="application-supply-and-demand-model" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="application-supply-and-demand-model"><span class="header-section-number">4.9</span> Application: supply and demand model</h2>
<p>(From Linear Algebra notebook by Herbert Hamers)</p>
<p>The demand <span class="math inline">q_d</span> and supply <span class="math inline">q_s</span> of an item depend on the price <span class="math inline">p</span> and income <span class="math inline">Y</span>. Suppose that the relation between demand, price and income can be described by the equation</p>
<p><span class="math display">q_d = 8 - 0.2p + 0.1Y,</span></p>
<p>and the relation between supply and price by the equation</p>
<p><span class="math display">q_s = 6 + 0.3p.</span></p>
<p>The market is in equilibrium if <span class="math inline">q_s = q_d</span>. Replacing both <span class="math inline">q_s</span> and <span class="math inline">q_d</span> by the new variable <span class="math inline">q</span>, the market equilibrium can be found by solving the following system of two linear equations for the unknowns <span class="math inline">p</span>, <span class="math inline">q</span> and <span class="math inline">Y</span>:</p>
<p><span class="math display">
\left\{\begin{array}{l}
q = 8 - 0.2p + 0.1Y\\
q = 6 + 0.3p.
\end{array}\right.
</span></p>
<p>First, we will rewrite this system of linear equations. We place all terms with a variable to the left of the equal sign and moreover we put terms with the same variable in the different equations right below each other:</p>
<p><span class="math display">
\left\{\begin{array}{l}
q + 0.2p - 0.1Y = 8\\
q - 0.3p = 6.
\end{array}\right.
</span></p>
<div id="75746c0a" class="cell" data-execution_count="25">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Ab <span class="op">=</span> sp.Matrix([[<span class="dv">1</span>, <span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="dv">8</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="fl">0.3</span>, <span class="dv">0</span>, <span class="dv">6</span>]]) </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>Ab</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="25">
<p><span class="math inline">\displaystyle \left[\begin{matrix}1 &amp; 0.2 &amp; -0.1 &amp; 8\\1 &amp; -0.3 &amp; 0 &amp; 6\end{matrix}\right]</span></p>
</div>
</div>
<p><strong>Exercise 5.8:</strong></p>
<p>How many solutions does this system of linear equations have? You can use the function <code>rref()</code> again to find the row reduced echelon form of the above matrix. Determine the solution if <span class="math inline">Y=50</span>.</p>
<div id="4d3258ad" class="cell" data-execution_count="26">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="symbolic-computation-of-the-determinant-in-python-with-sympy" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="symbolic-computation-of-the-determinant-in-python-with-sympy"><span class="header-section-number">4.10</span> Symbolic computation of the determinant in Python with <code>sympy</code></h2>
<p>The <code>sympy</code> package can also be used to calculate determinants of symbolic matrices.</p>
<p><strong>Exercise 5.9:</strong></p>
<p>We now investigate how to compute determinants of <em>symbolic</em> matrices using sympy. Let <span class="math display">
A = \begin{pmatrix}  1 &amp; 0 &amp; x \\ 1 &amp; -x &amp; 0 \\ x &amp; 0 &amp; -x \end{pmatrix}.
</span> Our goal will be to compute the determinant of <span class="math inline">A</span> in terms of <span class="math inline">x</span>. First we define the variable <span class="math inline">x</span> as a “symbolic” variable in Sympy.</p>
<div id="6bf3c857" class="cell" data-execution_count="27">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.symbols(<span class="st">'x'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next, carry out the following steps.</p>
<ul>
<li>Define the matrix A using the variable <span class="math inline">x</span>.</li>
<li>Compute the determinant of A using the command <code>A.det()</code>. For which values of <span class="math inline">x</span> does the determinant equal zero?</li>
<li>To be able to see more easily for which values of <span class="math inline">x</span> the determinant equals <span class="math inline">0</span>, you can use Sympy’s <code>sp.factor()</code> function to factor the determinant. The input of this function is the determinant of <span class="math inline">A</span>. Apply this function and argue for which values of <span class="math inline">x</span> the matrix <span class="math inline">A</span> is invertible.</li>
</ul>
<div id="8f68d67d" class="cell" data-execution_count="28">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># your code here</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="optional-row-reduction-with-intermediate-steps" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="optional-row-reduction-with-intermediate-steps"><span class="header-section-number">4.11</span> (Optional) Row reduction with intermediate steps</h2>
<p>This optional section describes a more advanced code snippet that implements a row-reduction algorithm from scratch, and allows you to output the intermediate operations. You should be able to read most of the code and recognize the algorithm, but some details have not been explained in this notebook. More specifically, you will see again for-loops and if-statements, but also “new” functions such as .copy(), .as_mutable(), .append(). If you are interested, we invite you to look up their documentation. You can also use this algorithm to revisit some examples that you have seen in the linear algebra course.</p>
<!-- The above section explained how to use sympy's rref() function to obtain the row-reduced echelon form of a matrix. That method, however, only provided the "final answer": it does not return the row-operations that have been performed. Below, we provide a Python script that implements a basic row reduction algorithm, shows all intermediate steps, and the operations that it performs. The script uses some basic Python functionalities that you have seen in these two lectures (for-loops, if-statements), but also more advanced features of the sympy package. (We do not explain here the functionality of .copy(), for example, but we invite you to look up the documentation in case you are interested.) -->
<p>As a disclaimer: this code has been generated using ChatGPT.</p>
<div id="2a6a0376" class="cell" data-execution_count="29">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy <span class="im">import</span> Matrix</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> rref_with_steps(mat):</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform row-reduction to RREF while recording intermediate steps and row operations.</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">        rref_matrix (Matrix),</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co">        pivot_columns (tuple),</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">        steps (list of (Matrix, str))  # Each step is (matrix_snapshot, operation_description)</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> mat.as_mutable().copy()</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> A.shape</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    pivots <span class="op">=</span> []</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    steps <span class="op">=</span> [(A.copy(), <span class="st">"Initial matrix"</span>)]</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    row <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> row <span class="op">&gt;=</span> rows:</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Find pivot row</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>        pivot_row <span class="op">=</span> <span class="va">None</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> r <span class="kw">in</span> <span class="bu">range</span>(row, rows):</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> A[r, col] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>                pivot_row <span class="op">=</span> r</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pivot_row <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Swap rows if needed</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pivot_row <span class="op">!=</span> row:</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>            A.row_swap(pivot_row, row)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>            steps.append((A.copy(), <span class="ss">f"Swap R</span><span class="sc">{</span>pivot_row<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> ↔ R</span><span class="sc">{</span>row<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Scale pivot row</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>        pivot_val <span class="op">=</span> A[row, col]</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pivot_val <span class="op">!=</span> <span class="dv">1</span>:</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>            A.row_op(row, <span class="kw">lambda</span> x, _: x <span class="op">/</span> pivot_val)</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>            steps.append((A.copy(), <span class="ss">f"R</span><span class="sc">{</span>row<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> → (1/</span><span class="sc">{</span>pivot_val<span class="sc">}</span><span class="ss">)·R</span><span class="sc">{</span>row<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Eliminate other rows</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> r <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> r <span class="op">!=</span> row <span class="kw">and</span> A[r, col] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>                factor <span class="op">=</span> A[r, col]</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>                A.row_op(r, <span class="kw">lambda</span> x, j: x <span class="op">-</span> factor <span class="op">*</span> A[row, j])</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>                steps.append((A.copy(), <span class="ss">f"R</span><span class="sc">{</span>r<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> → R</span><span class="sc">{</span>r<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> - (</span><span class="sc">{</span>factor<span class="sc">}</span><span class="ss">)·R</span><span class="sc">{</span>row<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>))</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>        pivots.append(col)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>        row <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> A, <span class="bu">tuple</span>(pivots), steps</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="f6534333" class="cell" data-execution_count="30">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> Matrix([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">3</span>],</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>            [<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">5</span>]])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>rref_matrix, pivots, steps <span class="op">=</span> rref_with_steps(A)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RREF:"</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rref_matrix)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Pivot columns:"</span>, pivots)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Steps:"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (s, op) <span class="kw">in</span> <span class="bu">enumerate</span>(steps):</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Step </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>op<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    display(s)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>RREF:
Matrix([[1, 2, 0], [0, 0, 1], [0, 0, 0]])
Pivot columns: (0, 2)

Steps:
Step 0: Initial matrix</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\displaystyle \left[\begin{matrix}1 &amp; 2 &amp; 1\\2 &amp; 4 &amp; 3\\3 &amp; 6 &amp; 5\end{matrix}\right]</span></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Step 1: R2 → R2 - (2)·R1</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\displaystyle \left[\begin{matrix}1 &amp; 2 &amp; 1\\0 &amp; 0 &amp; 1\\3 &amp; 6 &amp; 5\end{matrix}\right]</span></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Step 2: R3 → R3 - (3)·R1</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\displaystyle \left[\begin{matrix}1 &amp; 2 &amp; 1\\0 &amp; 0 &amp; 1\\0 &amp; 0 &amp; 2\end{matrix}\right]</span></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Step 3: R1 → R1 - (1)·R2</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\displaystyle \left[\begin{matrix}1 &amp; 2 &amp; 0\\0 &amp; 0 &amp; 1\\0 &amp; 0 &amp; 2\end{matrix}\right]</span></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Step 4: R3 → R3 - (2)·R2</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\displaystyle \left[\begin{matrix}1 &amp; 2 &amp; 0\\0 &amp; 0 &amp; 1\\0 &amp; 0 &amp; 0\end{matrix}\right]</span></p>
</div>
</div>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Under the hood, numpy for instance relies on BLAS and LAPACK for most of its linear algebraic subroutines. BLAS and LAPACK are written in a programming language called Fortran, see for example the <a href="https://www.netlib.org/lapack/#_presentation">LAPACK documentation</a>. LAPACK is used by many other programming languages, including Matlab.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-basics.html" class="pagination-link" aria-label="Python basics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python basics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-linear-optimization.html" class="pagination-link" aria-label="Linear optimization">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear optimization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>